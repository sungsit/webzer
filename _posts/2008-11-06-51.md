---
title: Drupal Colourise theme (EP.2)
layout: default
lang: th
---

<p><a href="http://webzer.net/node/50">คราวที่แล้ว</a> เราแนะนำให้ drupal รู้จักธีม Colourise ของเราไปแล้ว พร้อมทั้งจัดการนำส่วนเนื้อหาหลัก กับ sidebar มาแสดงในธีม คราวนี้มาสนุกกับส่วน header และ footer กันดีกว่า ก่อนอื่นเปิดใช้งานธีม Colourise ใน drupal เลยครับ ถ้าใครติดตั้ง <a href="http://drupal.org/project/switchtheme">โมดูล Switchtheme</a> แล้ว ก็จัดการเอา block ของมันมาไว้ที่ right sidebar ได้เลย เวลาเปลี่ยนธีมกลับไปกลับมาจะได้ไม่ลำบาก<br><img class="indent-pix" src="http://lh3.ggpht.com/_Y0CVoTNHnqo/SRCm_gzEmHI/AAAAAAAAALU/EkSf0CY05oE/s400/switchtheme-crop-1.png" alt="switchtheme-crop-1.png"></p>

<p>อีกอย่างก็ตั้งค่าใช้งานต่างๆของธีมเตรียมไว้ด้วย เช่น sitename , slogan , primary links , search และอื่นๆที่คิดว่าอยากเห็นในธีมของเรา (ผมขอไม่พูดถึงรายละเอียดวิธีการตั้งค่าพวกนี้นะครับ เพราะสันนิษฐานว่า "ผู้ใช้ drupal ที่ต้องการทำธีมเอง" คงรู้เรื่องการใช้งานพื้นฐานพวกนี้อยู่แล้ว)
</p>
<ol><li><strong>จัดการ sitename</strong> ธีม colourise ไม่มีโลโก้ มีแค่ชื่อเว็บ และชื่อเว็บใน drupal ก็คือ <strong><code>$site_name</code></strong> เริ่มจัดการกับมันด้วยการใช้ FireBug ค้นหาตำแหน่งที่ควรจะเป็น sitename ซึ่งก็คงไม่มีอะไรเหมาะไปกว่า <code>&lt;h1 id="logo-text"&gt;...&lt;/h1&gt;</code> ดังรูป<br><img src="http://lh6.ggpht.com/_Y0CVoTNHnqo/SRCdmU0scKI/AAAAAAAAAKY/JWL48OJS_5Q/s400/firebug-crop-2.png" alt="firebug-crop-2"></li>
<li><strong>เปลี่ยนชื่อให้เป็นเว็บไซต์ของเรา</strong> เปิดไฟล์ <strong>page.tpl.php</strong> ด้วยโปรแกรม text editor และเช่นเดียวกับคราวที่แล้ว ผมจะยังไม่อธิบายโค้ดแต่ละบรรทัดนะครับ แต่จะทำตัวอย่างให้ดูเลย แบบโค้ดข้างล่างนี้ (ขออภัย  ไม่ได้กั๊กนะ แต่ขี้เกียจจริงๆ) เราไม่ต้องเปลี่ยน markup เพราะเราจะยังไม่เปลี่ยนอะไรใน css แต่ใช้วิธีแทนฟังชั่นของ drupal ลงไปใน markup เดิม แล้ว save<br><div class="codeblock"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">if (</span><span style="color: #0000BB">$site_name</span><span style="color: #007700">): </span><span style="color: #0000BB">?&gt;</span></span><br>&lt;h1 id="logo-text"&gt;<br>	&lt;a href="<span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">print </span><span style="color: #0000BB">check_url</span><span style="color: #007700">(</span><span style="color: #0000BB">$front_page</span><span style="color: #007700">) </span><span style="color: #0000BB">?&gt;</span></span>" title="Go To Homepage"&gt;<span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">print </span><span style="color: #0000BB">$site_name ?&gt;</span></span>&lt;/a&gt;<br>&lt;/h1&gt;	<br><span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">endif; </span><span style="color: #0000BB">?&gt;</span></span></code></div><br>
เมื่อ refresh หน้าเว็บ drupal ก็จะเห็นชื่อเว็บไซต์ของเราโผล่มาแทนคำว่า Colourise ครับ เมื่อคลิ๊กมันก็เป็นลิ้งค์ที่พาเรากลับโฮมเพจ<br><img src="http://lh5.ggpht.com/_Y0CVoTNHnqo/SRChlzv5pdI/AAAAAAAAAK0/8MYr_em9B7M/s400/sitename-crop-1.png" alt="sitename-crop-1.png"></li>
<li><strong>ใส่สโลแกนซะ</strong> ใน drupal มันคือ <strong><code>$site_slogan</code></strong> ตำแหน่งที่เหมาะกับมัน ก็น่าจะเป็น <strong><code>&lt;p id="intro"&gt;...&lt;/p&gt;</code></strong> ทำเหมือนขั้นตอนที่แล้ว ด้วยโค้ด PHP คล้ายๆกัน<br><div class="codeblock"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">if (</span><span style="color: #0000BB">$site_slogan</span><span style="color: #007700">): </span><span style="color: #0000BB">?&gt;</span></span><br>&lt;p id="intro"&gt;<span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">print </span><span style="color: #0000BB">$site_slogan ?&gt;</span></span>&lt;/p&gt;<br><span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">endif; </span><span style="color: #0000BB">?&gt;</span></span></code></div><br>
เนื่องจากสโลแกนของ webzer มันสั้น ก็จะเห็นประมาณนี้<br><img src="http://lh5.ggpht.com/_Y0CVoTNHnqo/SRCkZX4X87I/AAAAAAAAALQ/um-g-oc8uCM/s400/sitename-crop-2.png" alt="sitename-crop-2.png"></li>
<li><strong>เหยื่อรายต่อมาก็็คือ <code>$primary_links</code></strong> ตำแหน่งที่เหมาะกับมันคือ <strong><code>&lt;div&nbsp; id="nav"&gt;...&lt;/div&gt;</code></strong> เนื่องจากใน drupal เราสามารถแสดง  primary links ของธีมเป็น list element ได้อยู่แล้ว (<code>&lt;ul&gt;...&lt;/ul&gt;</code>) เราก็ไม่ต้องเขียนซ้ำอีก ใช้โค้ดสั้นๆแบบข้างล่างนี้ก็พอ<br><div class="codeblock"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">if (isset(</span><span style="color: #0000BB">$primary_links</span><span style="color: #007700">)) : </span><span style="color: #0000BB">?&gt;</span></span><br>&lt;div&nbsp; id="nav"&gt;<br><span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">print </span><span style="color: #0000BB">theme</span><span style="color: #007700">(</span><span style="color: #DD0000">'links'</span><span style="color: #007700">, </span><span style="color: #0000BB">$primary_links</span><span style="color: #007700">) </span><span style="color: #0000BB">?&gt;</span></span><br>&lt;/div&gt;			<br><span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">endif; </span><span style="color: #0000BB">?&gt;</span></span></code></div><br>
(ใน drupal มันจะเซ็ตคลาส active ให้กับลิงค์ของเราด้วย แต่ตอนนี้เรายังไม่เห็น ต้องแก้ css ทีหลัง)<br><img src="http://lh3.ggpht.com/_Y0CVoTNHnqo/SRDE-OYev_I/AAAAAAAAALw/tZvrTED2gdY/s400/primary-links-1.png" alt="primary-links.png"></li>
<li><strong>แล้วก็มาถึง Search Bar ด้านบน</strong> การจัดการกับ Search Bar ดูเหมือนจะง่าย แต่ก็ไม่ง่าย และผมไม่ต้องการไปแตะต้องอะไรใน Search Module ทางที่ง่ายที่สุดที่จะแสดง Search Bar โดยตรงในธีม ก็คือเรียกใช้ <strong><code>$search_box</code></strong> โดยลบ <code>&lt;form id="quick-search" ... &lt;/form&gt;</code> ทิ้งไป แล้วใส่โค้ดสั้นๆแค่บรรทัดเดียว<br><div class="codeblock"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">print </span><span style="color: #0000BB">$search_box ?&gt;</span></span></code></div>
</li>
<li><strong>ได้เวลาสนุกกับ css แล้ว!</strong> เนื่องจากฟังชั่น <code>$search_box</code> เมื่อพรินต์ออกมาในหน้าเว็บของเรา มันดันมาซ้อนกับ primary links ที่ด้านซ้าย ก็ไม่ต้องตกใจครับ เพราะ css รับมือมันได้อยู่แล้ว เปิดไฟล์ <strong>Colourise.css</strong> ใน text editor แล้วมองหาส่วนที่เค้าคอมเมนต์เอาไว้ว่า <code>/* header search */</code> (ประมาณบรรทัดที่ 230) แล้วก็จัดการแทนค่า attribute ให้ตรงกับ markup ใน <code>$search_box</code> แบบนี้<br><div class="codeblock"><code>/* header search */<br>#header form#search-theme-form {<br>	position: absolute;<br>	top: 38px; right: 0;<br>	padding: 0; margin: 0;<br>	border: none;<br>	width: 262px; height: 30px;<br>	background: url(header-search.jpg) no-repeat;	<br>	z-index: 999999;<br>}<br>#header form#search-theme-form .form-text {<br>	margin: 2px 0 0 5px; <br>	width: 210px;<br>	background: none;<br>	border: none;<br>}<br>#header form#search-theme-form label,<br>#header form#search-theme-form .form-submit {<br>	display: none;	<br>}</code></div><br>
เราแค่เปลี่ยน attribute พวก id กับ class ให้ตรงกับ markup โดยไม่ได้เปลี่ยนค่าอะไรของ css อย่างเช่น อันเดิมมันเป็น <code>id="quick-search"</code> อันใหม่มันคือ <code>id="search-theme-form"</code> เราก็แก้ <code>#header form#quick-search</code> ใน css ให้เป็น <code>#header form#search-theme-form</code> เป็นต้น (ถ้าไม่คุ้นเคยกับ css อาจจะงงครับ และผมก็ไม่รู้จะอธิบายให้เข้าใจได้ง่ายๆยังไง) ถ้าไม่มีอะไรผิดพลาด องค์ประกอบของส่วน header ก็จะเป็นแบบภาพข้างล่างนี้ (ขออภัยสีสันอาจไม่เหมือนจริง เพราะบีบไฟล์ให้เล็กลง)<br><img src="http://lh3.ggpht.com/_Y0CVoTNHnqo/SRDHc0YDF0I/AAAAAAAAAL0/14nl1gxXZVU/s400/full-header-2.png" alt="full-header.png"></li>
<li><strong>แล้วส่วนหัวของเราก็เสร็จ มาเก็บหางกันต่อ!</strong> เนื่องจากผมอยากจะจัดการกับ block ในส่วน footer ทีหลัง เลยขอเคลียร์มันทิ้งไปก่อน คราวหน้าค่อยมากำหนด block regions ให้มันใหม่ เพราะยังไงก็ต้อง rewrite css อยู่แล้ว และโค้ดที่จะเหลือในส่วน footer จนถึงบรรทัดสุดท้ายของไฟล์ page.tpl.php ก็เป็นดังนี้ครับ<br><div class="codeblock"><code>	&lt;!-- footer starts here --&gt;	<br>	&lt;div id="footer-wrap"&gt;<br>	&lt;div id="footer-content"&gt;<br><span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">if (</span><span style="color: #0000BB">$footer_message</span><span style="color: #007700">): </span><span style="color: #0000BB">?&gt;</span></span><br>		&lt;p&gt;<span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">print </span><span style="color: #0000BB">$footer_message ?&gt;</span></span>&lt;/p&gt;<br><span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">endif; </span><span style="color: #0000BB">?&gt;</span></span><br>		&lt;p&gt;Original Design From &lt;a href="http://www.styleshout.com/"&gt;StyleShout.com&lt;/a&gt; (&lt;a href="http://creativecommons.org/licenses/by/2.5/"&gt;Creative Commons Attribution 2.5 License&lt;/a&gt;). Ported to Drupal by &lt;a href="http://webzer.net/"&gt;Webzer.net&lt;/a&gt;.&lt;/p&gt;<br>	&lt;/div&gt;<br>	&lt;/div&gt;<br><br>	&lt;div class="clearer"&gt;&lt;/div&gt;<br>	&lt;!-- footer ends here --&gt;<br><br>&lt;!-- wrap ends here --&gt;<br>&lt;/div&gt;<br><span style="color: #000000"><span style="color: #0000BB">&lt;?php </span><span style="color: #007700">print </span><span style="color: #0000BB">$closure ?&gt;</span></span><br>&lt;/body&gt;<br>&lt;/html&gt;</code></div><br><strong><code>$footer_message</code></strong> ใช้แสดงส่วนเครดิตของเว็บไซต์ ส่วนย่อหน้าและลิ้งค์ที่ผมเติมเข้ามาก็เพื่อให้เกียรติต้นแบบดีไซน์ เพราะ colourise template อันนี้เป็น <a href="http://creativecommons.org/licenses/by/2.5/">Creative Commons Attribution 2.5 License</a> เราก็ต้องส่งต่อการเผยแพร่ในลักษณะเดียวกัน ส่วน <strong><code>$closure</code></strong> ก่อนแท็ค body ไม่เกี่ยวกับธีม แต่ต้องใส่ไว้เพื่อให้ drupal พรินต์พวกสคริปต์ของโมดูลบางตัว เช่น google analytics หรือ javascript
</li>
<li><strong>รอดไปอีกหนึ่งขั้น</strong> แต่ผมยังไม่ได้ใส่ฟังชั่นพื้นฐานบางตัวของ drupal ลงไปในธีมนะครับ เช่น <strong><code>$breadcrumb</code></strong> , <strong><code>$secondary_links</code></strong> เป็นต้น แต่ตอนนี้มันก็ใช้งานได้แล้วล่ะ ลองเปิดใช้งานส่วนต่างๆของธีมดูนะครับ หรือ ลองเล่น Switch Theme จาก sidebar ของ webzer ก็ได้ (แต่บางทีมันก็ไม่ switch ให้ สงสัยว่าจะเป็น cache)
</li>
</ol>

<p>ในธีมตัวอย่างที่เป็นไฟล์แนบด้านล่างนี้ สามารถเอาไปทดลองติดตั้งได้เลย (ไฟล์มันใหญ่เพราะภาพแบ็คกราวนด์ครับ และถ้ามันคลาย .zip ออกมา ก็อย่าลืมเปลี่ยนชื่อโฟลเดอร์เป็น colourise แทน colourise-sample-2 ก่อนเอาไปใช้ใน drupal นะครับ) ผมใส่คอมเมนต์ภาษาไทยไว้ในไฟล์ page.tpl.php ด้วย เพื่อบอกคร่าวๆ ว่าแต่ละฟังชั่นมีไว้ทำอะไร รวมทั้งแอบแก้ css ไปล่วงหน้าแล้ว เพื่อให้มองเห็นตัวหนังสือได้ง่ายขึ้น ใช้ใน localhost ได้เลย แต่อย่าเพิ่งเอาไปใช้กับเว็บไซต์จริงนะครับ (แต่ผมก็เอามาใช้แล้วล่ะ) เพราะยังเหลืออะไรที่ต้องแก้อีกเยอะ คราวหน้าค่อย "ทำให้มันเนียน" ด้วยการตกแต่งรายละเอียดที่จำเป็น เช่น ตำแหน่งของ block , เคลียร์อะไรที่ไม่จำเป็นออกไป และคงได้สนุกกับ css และ ไฟล์อื่นๆของ drupal กันมากขึ้น (มีใครคิดว่ามันสนุกบ้างมั้ยเนี่ย?)
</p>

<p><strong>Attachment:</strong> <a class="no-ajaxy" href="/sites/webzer.net/files/colourise-sample-2_0.zip">colourise-sample-2</a></p>
